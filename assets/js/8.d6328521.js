(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{365:function(e,t,a){e.exports=a.p+"assets/img/7.cache-workflow.drawio.df957c5b.svg"},382:function(e,t,a){"use strict";a.r(t);var s=a(45),o=Object(s.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"api-cache-design-patten"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#api-cache-design-patten"}},[e._v("#")]),e._v(" API Cache Design Patten")]),e._v(" "),s("h2",{attrs:{id:"backgound"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#backgound"}},[e._v("#")]),e._v(" Backgound")]),e._v(" "),s("p",[e._v("We have some APIs that take a long time to proceed. The end users will see a loading indicator for a while before they can see the content. Even worse, some of the APIs may timeout because of that. As a result, our end users will never see the content anymore.")]),e._v(" "),s("h2",{attrs:{id:"solution"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#solution"}},[e._v("#")]),e._v(" Solution")]),e._v(" "),s("p",[e._v("We have come up with a solution to handle this with cache.")]),e._v(" "),s("h2",{attrs:{id:"workflow"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#workflow"}},[e._v("#")]),e._v(" Workflow")]),e._v(" "),s("ol",[s("li",[e._v("When we retrieve the data we need, we always retrieve it from the cache, instead of querying from the API.")]),e._v(" "),s("li",[e._v("When we enroll a new user to the experience, initialise the cached data for this user.")]),e._v(" "),s("li",[e._v("When some event happens that will change the cached data, put a job in the "),s("strong",[e._v("queue")]),e._v(" to re-calculate the data and update the cache.")]),e._v(" "),s("li",[e._v("Once the cache has been updated to the latest, notify the user with a Pusher event.")])]),e._v(" "),s("p",[s("img",{attrs:{src:a(365),alt:"Workflow"}})]),e._v(" "),s("h2",{attrs:{id:"example-workflow"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#example-workflow"}},[e._v("#")]),e._v(" Example workflow")]),e._v(" "),s("p",[e._v("Progress:")]),e._v(" "),s("ol",[s("li",[e._v("When we enroll a new user, put a job in the queue to initiate the progress cache.")]),e._v(" "),s("li",[e._v("When the user go to the App to see the progress, API will get it from the cache.")]),e._v(" "),s("li",[e._v("When the user submit an assesssment that will change the progress, put a job in the queue to update the cache.")]),e._v(" "),s("li",[e._v("Once the cache has been updated, notify the App via Pusher channel.")]),e._v(" "),s("li",[e._v("When App receive the Pusher event, retrieve the data from cache again.")])]),e._v(" "),s("h2",{attrs:{id:"apis"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#apis"}},[e._v("#")]),e._v(" APIs")]),e._v(" "),s("p",[e._v("We've implemented this cache strategy to the following APIs:")]),e._v(" "),s("ul",[s("li",[e._v("[CORE] "),s("code",[e._v("/api/milestones")])]),e._v(" "),s("li",[e._v("[CORE] "),s("code",[e._v("/api/v2/motivations/progress/list")])])])])}),[],!1,null,null,null);t.default=o.exports}}]);